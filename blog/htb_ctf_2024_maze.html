<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<meta name="twitter:card" content="summary">
	<title>CTF: Maze and BunnyPass | Sleepy Pony Labs</title>
	<meta property="og:title" content="CTF: Maze and BunnyPass | Sleepy Pony Labs">
	<meta name="twitter:title" content="CTF: Maze and BunnyPass | Sleepy Pony Labs">
	
	<meta name="description" content="Writeup for HTB Cyber Apocalypse 2024 - Maze and BunnyPass">
	<meta property="og:description" content="Writeup for HTB Cyber Apocalypse 2024 - Maze and BunnyPass">
	<meta name="twitter:description" content="Writeup for HTB Cyber Apocalypse 2024 - Maze and BunnyPass">
	
	<meta property="og:image" content="https://www.sleepyponylabs.com/images/htb_ctf_2024/bunnypass/cover.png">
	<meta name="twitter:image" content="https://www.sleepyponylabs.com/images/htb_ctf_2024/bunnypass/cover.png">
	
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://www.sleepyponylabs.com/blog/htb_ctf_2024_maze.html/">
    
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/pure-min.css">
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.5/build/grids-responsive-min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/ce52e489fc.js" crossorigin="anonymous"></script>
</head>

<body>
<div class="custom-wrapper pure-g header" id="menu">
  <div class="pure-u-1 pure-u-md-1-3 pure-u-lg-1-4 pure-u-xl-1-6">
    <div class="home-menu pure-menu pure-menu-fixed">
      <a class="pure-menu-heading" href="/blog/index.html">
		<i class="fa fa-arrow-left"></i>
		Back to blog index</a>
    </div>
  </div>
</div>

<div class="content">
  <h1>Sleepy Pony @ Cyber Apocalypse 2024 CTF!</h1>
  <h2>Vol 1: Maze and BunnyPass</h2>
  
  <div class="content-body">
    <div class="pure-g">
	  <div class="pure-u-1">
	    <h3>Preface</h3>
	    <p>
		  This is my first time trying my hands on a CTF event: <b>HackTheBox Cyber Apocalypse 2024</b>!
		  I'm no hacker, but this event has a <i>hardware</i> category, so my friend invited me to a team to try them out.
		  It turned out better than I thought! I was able to solve <b>all</b> of the 5 hardware CTFs! And here's my writeup.
	    </p>
		
		<h3>Maze - Very Easy</h3>
		
		<div>
		  <h4>Problem Statement</h4>
		  <p>
			<i>In a world divided by factions, "AM," a young hacker from the Phreaks, found himself falling in love with "echo," 
			a talented security researcher from the Revivalists. Despite the different backgrounds, you share a common goal: dismantling The Fray. 
			You still remember the first interaction where you both independently hacked into The Fray's systems and stumbled upon the same vulnerability in a printer. 
			Leaving behind your hacker handles, "AM" and "echo," you connected through IRC channels and began plotting your rebellion together. 
			Now, it's finally time to analyze the printer's filesystem. What can you find?</i>
		  </p>
	    </div>
		
		<div>
		  <h4>What's Provided?</h4>
		  <ul>
		    <li>One zip file</li>
		  </ul>
		</div>
		
		<div>
		  <h4>Capturing the Flag</h4>
		  <p>
			Upon extracting the files, we found out that what we got is a filesystem archive of an HP printer.
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/maze/fs.png" alt="HP ChaiServer Filesystem" width="60%" height="60%">
		      <p>HP ChaiServer Filesystem</p>
		    </div>
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/maze/config.png" alt="HP WebServer Config" width="80%" height="100%">
		      <p>HP WebServer Config</p>
		    </div>
	      </div>
		  
		  <p>
		    After exploring the files a bit, we found an unfinished job in the <b>fs/saveDevice/SavedJobs/InProgress</b> directory:
			A PDF file <b>Factory.pdf</b>
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/maze/pdf.png" alt="A PDF file Factory.pdf" width="80%" height="80%">
		      <p>A suspicious PDF file appears!</p>
		    </div>
	      </div>
		  
		  <p>
		    And what do we have here, the flag!
		  </p>
		  <p>
			<code><b>HTB{1n7323571n9_57uff_1n51d3_4_p21n732}</b></code>
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/maze/pdf_flag.png" alt="A CTF flag hidden in a pdf file" width="80%" height="80%">
		      <p>Here is our flag on the second page</p>
		    </div>
	      </div>
		  
		  <p>
		    <b>Disclaimer:</b> Stupid sleepy pony actually did not solve this one for the team.
			Someone did because the pony did not check to see if the PDF has multiple pages… pfff…
		  </p>
		</div>
		
		<h3>~~~~~</h3>
		
		<h3>BunnyPass - Very Easy</h3>
		
		<div>
		  <h4>Problem Statement</h4>
		  <p>
			<i>As you discovered in the PDF, the production factory of the game is revealed. 
			This factory manufactures all the hardware devices and custom silicon chips (of common components) 
			that The Fray uses to create sensors, drones, and various other items for the games. 
			Upon arriving at the factory, you scan the networks and come across a RabbitMQ instance. 
			It appears that default credentials will work.</i>
		  </p>
	    </div>
		
		<div>
		  <h4>What's Provided?</h4>
		  <ul>
		    <li>A Docker instance</li>
		  </ul>
		</div>
		
		<div>
		  <h4>Capturing the Flag</h4>
		  <p>
			Upon arrival at the specified web page, we arrived at a RabbitMQ login page.
			Since the problem statement said <i>It appears that default credentials will work.</i>
			a quick google search told us that the default credentials is
			<ul>
			  <li>Username = guest</li>
			  <li>Password = guest</li>
			</ul>
			And now we are in!
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/bunnypass/login.png" alt="RabbitMQ Login Page" width="60%" height="60%">
		      <p>RabbitMQ Login Page</p>
		    </div>
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/bunnypass/cred.png" alt="RabbitMQ Default Credentials" width="80%" height="100%">
		      <p>Thanks Google!</p>
		    </div>
	      </div>
		  
		  <h4>But what is RabbitMQ anyway?</h4>
		  <p>
		    To be short, RabbitMQ is an <b>MQTT Broker</b>. 
			In contrast of a typical client-server architecture, MQTT uses a publish-subscribe architecture.
			This requires one server to act as a broker to facilitate message transfer from publishers to subscribers, based on topic of the messages.
			MQTT is popular in an IoT settings because you don't have to ping the server continuously for data. It's all event based! 
		  </p>
		  <p>
		    Read more at <a href="https://www.rabbitmq.com/">rabbitmq.com</a> and <a href="https://mqtt.org/">mqtt.org</a>
		  </p>
		  
		  <h4>OK, now what?</h4>
		  <p>
		    Since we know RabbitMQ is an MQTT broker, it must have message queues for storing the data published by the publishers,
			waiting to be sent to subscribers that are subscribed to the topic.
			Conveniently RabbitMQ has a GUI for us to query them right on the browser. Just go to <b>Queues</b> tab.
		  </p>
		  <p>
			<code><b>HTB{1n7323571n9_57uff_1n51d3_4_p21n732}</b></code>
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/bunnypass/queues.png" alt="MQTT Message Queues on the Broker" width="80%" height="80%">
		      <p>MQTT Message Queues on the Broker</p>
		    </div>
	      </div>
		  
		  <p>
		    Now we just go query up each topic, and in no time we found our flag in the <b>factory_idle</b> topic.
		  </p>
		  <p>
			<code><b>HTB{th3_hunt3d_b3c0m3s_th3_hunt3r}</b></code>
		  </p>
		  <div class="content-image">
		    <div class="pure-u-1">
		      <img src="/images/htb_ctf_2024/bunnypass/flag.png" alt="Flag Hidden in the MQTT Message Queue" width="80%" height="80%">
		      <p>Here is our flag!</p>
		    </div>
	      </div>
		</div>
		
		<h3>~~~~~</h3>
		
		<p>
		  <h4>Here is the end of Vol 1. On the next volume we will go into The PROM next.</h4>
		</p>
		
		<h4>~~~~~</h4>
		<h4>Last Update: 14 Mar 2024</h4>
	  </div>
    </div>
  </div>
 </div>
</body>